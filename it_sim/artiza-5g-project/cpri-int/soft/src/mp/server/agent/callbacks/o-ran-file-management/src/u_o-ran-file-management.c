/*
 * Copyright (c) 2008 - 2012, Andy Bierman, All Rights Reserved.
 * Copyright (c) 2012 - 2019, YumaWorks, Inc., All Rights Reserved.
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 *

*** Generated by yangdump-sdk 18.10-9

    User SIL-SA module
    module o-ran-file-management
    revision 2019-02-04
    namespace urn:o-ran:file-management:1.0
    organization O-RAN Alliance
    Created: 2019-06-21T02:49:12Z
    CLI parameters:
        format uc
        indent 4
        module o-ran-file-management
        output u_o-ran-file-management.c
        sil-get2
        sil-sa
        unified true

 */

#include <xmlstring.h>

#include "procdefs.h"
#include "agt.h"
#include "agt_action.h"
#include "agt_cb.h"
#include "agt_not.h"
#include "agt_rpc.h"
#include "agt_sil_lib.h"
#include "agt_timer.h"
#include "agt_util.h"
#include "agt_val.h"
#include "cfg.h"
#include "dlq.h"
#include "getcb.h"
#include "ncx.h"
#include "ncx_feature.h"
#include "ncxmod.h"
#include "ncxtypes.h"
#include "obj.h"
#include "rpc.h"
#include "ses.h"
#include "sil_sa.h"
#include "status.h"
#include "val.h"
#include "val_child.h"
#include "val_util.h"
#include "xml_util.h"
#include "xml_val.h"
#include "u_o-ran-file-management.h"
#include "y_o-ran-file-management.h"

#include "i_o-ran-file-management.h"
#include "f_saa_sil_lib.h"

#define D_FLM_RPC_SUCCESS (const xmlChar *)"SUCCESS"
#define D_FLM_RPC_FAILURE (const xmlChar *)"FAILURE"

static obj_template_t *file_upload_notification_obj;
static obj_template_t *file_download_event_obj;

/* put your static variables here */
static  ncx_module_t *o_ran_file_management_mod = NULL;

/********************************************************************
* FUNCTION u_o_ran_file_management_file_upload_validate
*
* RPC validation phase
* All YANG constraints have passed at this point.
* Add description-stmt checks in this function.
*
* INPUTS:
*     see agt/agt_rpc.h for details
*
* RETURNS:
*     error status
********************************************************************/
status_t u_o_ran_file_management_file_upload_validate (
    ses_cb_t *scb,
    rpc_msg_t *msg,
    xml_node_t *methnode)
{
    status_t res = NO_ERR;
    val_value_t *errorval = NULL;

    if (LOGDEBUG) {
        log_debug("\nStart SIL validate rpc <file-upload> from module o-ran-file-management");
    }

    val_value_t *inputval = agt_get_rpc_input(msg);
    if (inputval == NULL) return ERR_NCX_OPERATION_FAILED;

    val_value_t *v_local_logical_file_path_val = NULL;
    xmlChar *v_local_logical_file_path = NULL;

    val_value_t *v_remote_file_path_val = NULL;
    xmlChar *v_remote_file_path = NULL;

    xmlChar *v_password = NULL;

    v_local_logical_file_path_val = val_find_child(
        inputval,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_local_logical_file_path);
    if (v_local_logical_file_path_val) {
        v_local_logical_file_path = VAL_STRING(v_local_logical_file_path_val);
    }

    v_remote_file_path_val = val_find_child(
        inputval,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_remote_file_path);
    if (v_remote_file_path_val) {
        v_remote_file_path = VAL_STRING(v_remote_file_path_val);
    }

    v_password = f_saa_com_sil_get_password(msg);

    int rc = 0;
    rc = i_o_ran_file_management_file_upload_validate(
            v_local_logical_file_path,v_remote_file_path, v_password);
    if(rc != 0){
        res = ERR_NCX_INVALID_VALUE;
    }

    if (res != NO_ERR) {
        agt_record_error(
            scb,
            &msg->mhdr,
            NCX_LAYER_OPERATION,
            res,
            methnode,
            (errorval) ? NCX_NT_VAL : NCX_NT_NONE,
            errorval,
            (errorval) ? NCX_NT_VAL : NCX_NT_NONE,
            errorval);
    }
    return res;

} /* u_o_ran_file_management_file_upload_validate */


/********************************************************************
* FUNCTION u_o_ran_file_management_file_upload_invoke
*
* RPC invocation phase
* All constraints have passed at this point.
* Call device instrumentation code in this function.
*
* INPUTS:
*     see agt/agt_rpc.h for details
*
* RETURNS:
*     error status
********************************************************************/
status_t u_o_ran_file_management_file_upload_invoke (
    ses_cb_t *scb,
    rpc_msg_t *msg,
    xml_node_t *methnode)
{
    status_t res = NO_ERR;

    if (LOGDEBUG) {
        log_debug("\nStart SIL invoke rpc <file-upload> from module o-ran-file-management");
    }

    val_value_t *inputval = agt_get_rpc_input(msg);
    if (inputval == NULL) return ERR_NCX_OPERATION_FAILED;

    val_value_t *v_local_logical_file_path_val = NULL;
    xmlChar *v_local_logical_file_path = NULL;

    val_value_t *v_remote_file_path_val = NULL;
    xmlChar *v_remote_file_path = NULL;

    xmlChar *v_password = NULL;

    v_local_logical_file_path_val = val_find_child(
        inputval,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_local_logical_file_path);
    if (v_local_logical_file_path_val) {
        v_local_logical_file_path = VAL_STRING(v_local_logical_file_path_val);
    }

    v_remote_file_path_val = val_find_child(
        inputval,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_remote_file_path);
    if (v_remote_file_path_val) {
        v_remote_file_path = VAL_STRING(v_remote_file_path_val);
    }

    v_password = f_saa_com_sil_get_password(msg);

    /* remove the next line if scb is used */
    (void)scb;

    /* remove the next line if methnode is used */
    (void)methnode;

    /* invoke your device instrumentation code here */
    int rc = 0;
    xmlChar message[D_FLM_MAX_MESSAGE_LEN];

    rc = i_o_ran_file_management_file_upload_invoke(
            v_local_logical_file_path,
            v_remote_file_path, v_password,
            message);

    xmlns_id_t nsid = o_ran_file_management_mod->nsid;
    val_value_t *status_val = NULL;
    
    if(rc == 0){
        status_val = val_make_string(nsid,
            y_o_ran_file_management_N_status, D_FLM_RPC_SUCCESS);
        dlq_enque(status_val, &msg->rpc_dataQ);

    }
    else{
        status_val = val_make_string(nsid,
            y_o_ran_file_management_N_status, D_FLM_RPC_FAILURE);
        dlq_enque(status_val, &msg->rpc_dataQ);

        status_val = val_make_string(nsid,
            y_o_ran_file_management_N_reject_reason, message);
        dlq_enque(status_val, &msg->rpc_dataQ);
    }

    return res;

} /* u_o_ran_file_management_file_upload_invoke */


/********************************************************************
* FUNCTION u_o_ran_file_management_retrieve_file_list_validate
*
* RPC validation phase
* All YANG constraints have passed at this point.
* Add description-stmt checks in this function.
*
* INPUTS:
*     see agt/agt_rpc.h for details
*
* RETURNS:
*     error status
********************************************************************/
status_t u_o_ran_file_management_retrieve_file_list_validate (
    ses_cb_t *scb,
    rpc_msg_t *msg,
    xml_node_t *methnode)
{
    status_t res = NO_ERR;
    val_value_t *errorval = NULL;

    if (LOGDEBUG) {
        log_debug("\nStart SIL validate rpc <retrieve-file-list> from module o-ran-file-management");
    }

    val_value_t *inputval = agt_get_rpc_input(msg);
    if (inputval == NULL) return ERR_NCX_OPERATION_FAILED;

    val_value_t *v_logical_path_val = NULL;
    xmlChar *v_logical_path = NULL;

    val_value_t *v_file_name_filter_val = NULL;
    xmlChar *v_file_name_filter = NULL;

    v_logical_path_val = val_find_child(
        inputval,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_logical_path);
    if (v_logical_path_val) {
        v_logical_path = VAL_STRING(v_logical_path_val);
        if(LOGDEV1){
            log_dev0("\n%s: v_logical_path=%p", __func__, v_logical_path);
        }
    }
    else{
        if(LOGWARN){
            log_warn("\n%s: v_logical_path_val is NULL.", __func__);
        }
    }

    v_file_name_filter_val = val_find_child(
        inputval,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_file_name_filter);
    if (v_file_name_filter_val) {
        v_file_name_filter = VAL_STRING(v_file_name_filter_val);
        if(LOGDEV1){
            log_dev0("\n%s: v_file_name_filter=%p", __func__, v_file_name_filter);
        }
    }
    else{
        if(LOGWARN){
            log_warn("\n%s: v_file_name_filiter is NULL.", __func__);
        }
    }

    int rc = 0;
    rc = i_o_ran_file_management_retrieve_file_list_validate(
            v_logical_path, v_file_name_filter);
    if(rc != 0){
        res = ERR_NCX_INVALID_VALUE;
    }

    if (res != NO_ERR) {
        agt_record_error(
            scb,
            &msg->mhdr,
            NCX_LAYER_OPERATION,
            res,
            methnode,
            (errorval) ? NCX_NT_VAL : NCX_NT_NONE,
            errorval,
            (errorval) ? NCX_NT_VAL : NCX_NT_NONE,
            errorval);
    }
    return res;

} /* u_o_ran_file_management_retrieve_file_list_validate */


/********************************************************************
* FUNCTION u_o_ran_file_management_retrieve_file_list_invoke
*
* RPC invocation phase
* All constraints have passed at this point.
* Call device instrumentation code in this function.
*
* INPUTS:
*     see agt/agt_rpc.h for details
*
* RETURNS:
*     error status
********************************************************************/
status_t u_o_ran_file_management_retrieve_file_list_invoke (
    ses_cb_t *scb,
    rpc_msg_t *msg,
    xml_node_t *methnode)
{
    status_t res = NO_ERR;

    if (LOGDEBUG) {
        log_debug("\nStart SIL invoke rpc <retrieve-file-list> from module o-ran-file-management");
    }

    val_value_t *inputval = agt_get_rpc_input(msg);
    if (inputval == NULL) return ERR_NCX_OPERATION_FAILED;

    val_value_t *v_logical_path_val = NULL;
    xmlChar *v_logical_path = NULL;

    val_value_t *v_file_name_filter_val = NULL;
    xmlChar *v_file_name_filter = NULL;

    v_logical_path_val = val_find_child(
        inputval,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_logical_path);
    if (v_logical_path_val) {
        v_logical_path = VAL_STRING(v_logical_path_val);
    }

    v_file_name_filter_val = val_find_child(
        inputval,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_file_name_filter);
    if (v_file_name_filter_val) {
        v_file_name_filter = VAL_STRING(v_file_name_filter_val);
    }

    /* remove the next line if scb is used */
    (void)scb;

    /* remove the next line if methnode is used */
    (void)methnode;

    /* invoke your device instrumentation code here */
    int rc = 0;
    xmlChar message[D_FLM_MAX_MESSAGE_LEN];
    xmlChar **file_list = NULL;

    rc = i_o_ran_file_management_retrieve_file_list_invoke(
            v_logical_path,
            v_file_name_filter,
            &file_list,
            message);

    if(LOGDEV0){
        log_dev0("\n%s: i_o_ran_file_management_retrieve_file_list_invoke returned %d.", __func__, rc);
    }

    xmlns_id_t nsid = o_ran_file_management_mod->nsid;
    val_value_t *status_val = NULL;
    val_value_t *file_val = NULL;
    
    if(rc == 0){
        status_val = val_make_string(nsid,
            y_o_ran_file_management_N_status, D_FLM_RPC_SUCCESS);
        dlq_enque(status_val, &msg->rpc_dataQ);

        /* リストを作って返す。 */
        int i = 0;
        for(i=0;file_list[i] != NULL && i < D_FLM_MAX_FILE_NUM; i++){
            file_val = val_make_string(nsid,
                y_o_ran_file_management_N_file_list, file_list[i]);
            dlq_enque(file_val, &msg->rpc_dataQ);
        }
    }
    else{
        status_val = val_make_string(nsid,
            y_o_ran_file_management_N_status, D_FLM_RPC_FAILURE);
        dlq_enque(status_val, &msg->rpc_dataQ);

        status_val = val_make_string(nsid,
            y_o_ran_file_management_N_reject_reason, message);
        dlq_enque(status_val, &msg->rpc_dataQ);

    }
    
    return res;

} /* u_o_ran_file_management_retrieve_file_list_invoke */


/********************************************************************
* FUNCTION u_o_ran_file_management_file_download_validate
*
* RPC validation phase
* All YANG constraints have passed at this point.
* Add description-stmt checks in this function.
*
* INPUTS:
*     see agt/agt_rpc.h for details
*
* RETURNS:
*     error status
********************************************************************/
status_t u_o_ran_file_management_file_download_validate (
    ses_cb_t *scb,
    rpc_msg_t *msg,
    xml_node_t *methnode)
{
    status_t res = NO_ERR;
    val_value_t *errorval = NULL;

    if (LOGDEBUG) {
        log_debug("\nStart SIL validate rpc <file-download> from module o-ran-file-management");
    }

    val_value_t *inputval = agt_get_rpc_input(msg);
    if (inputval == NULL) return ERR_NCX_OPERATION_FAILED;

    val_value_t *v_local_logical_file_path_val = NULL;
    const xmlChar *v_local_logical_file_path;

    val_value_t *v_remote_file_path_val = NULL;
    const xmlChar *v_remote_file_path;

    val_value_t *v_credentials_val = NULL;
    obj_template_t *v_credentials_obj = NULL;

    v_local_logical_file_path_val = val_find_child(
        inputval,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_local_logical_file_path);
    if (v_local_logical_file_path_val) {
        v_local_logical_file_path = VAL_STRING(v_local_logical_file_path_val);
    }

    v_remote_file_path_val = val_find_child(
        inputval,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_remote_file_path);
    if (v_remote_file_path_val) {
        v_remote_file_path = VAL_STRING(v_remote_file_path_val);
    }

    v_credentials_obj = obj_find_child(
        VAL_OBJ(inputval),
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_credentials);
    if (v_credentials_obj) {
        v_credentials_val = val_get_choice_first_set(
            inputval,
            v_credentials_obj);
        while (v_credentials_val) {
            /* process the input variable here */

            /* get the next child set in the selected case */
            v_credentials_val = val_get_choice_next_set(
                v_credentials_obj, 
                v_credentials_val);
        }
    }

    /* this funnction is not supported now */
    (void)v_local_logical_file_path; /* pgr0000 */
    (void)v_remote_file_path;        /* pgr0000 */

    if (res != NO_ERR) {
        agt_record_error(
            scb,
            &msg->mhdr,
            NCX_LAYER_OPERATION,
            res,
            methnode,
            (errorval) ? NCX_NT_VAL : NCX_NT_NONE,
            errorval,
            (errorval) ? NCX_NT_VAL : NCX_NT_NONE,
            errorval);
    }
    return res;

} /* u_o_ran_file_management_file_download_validate */


/********************************************************************
* FUNCTION u_o_ran_file_management_file_download_invoke
*
* RPC invocation phase
* All constraints have passed at this point.
* Call device instrumentation code in this function.
*
* INPUTS:
*     see agt/agt_rpc.h for details
*
* RETURNS:
*     error status
********************************************************************/
status_t u_o_ran_file_management_file_download_invoke (
    ses_cb_t *scb,
    rpc_msg_t *msg,
    xml_node_t *methnode)
{
    status_t res = NO_ERR;

    if (LOGDEBUG) {
        log_debug("\nStart SIL invoke rpc <file-download> from module o-ran-file-management");
    }

    val_value_t *inputval = agt_get_rpc_input(msg);
    if (inputval == NULL) return ERR_NCX_OPERATION_FAILED;

    val_value_t *v_local_logical_file_path_val = NULL;
    const xmlChar *v_local_logical_file_path;

    val_value_t *v_remote_file_path_val = NULL;
    const xmlChar *v_remote_file_path;

    val_value_t *v_credentials_val = NULL;
    obj_template_t *v_credentials_obj = NULL;

    v_local_logical_file_path_val = val_find_child(
        inputval,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_local_logical_file_path);
    if (v_local_logical_file_path_val) {
        v_local_logical_file_path = VAL_STRING(v_local_logical_file_path_val);
    }

    v_remote_file_path_val = val_find_child(
        inputval,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_remote_file_path);
    if (v_remote_file_path_val) {
        v_remote_file_path = VAL_STRING(v_remote_file_path_val);
    }

    v_credentials_obj = obj_find_child(
        VAL_OBJ(inputval),
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_credentials);
    if (v_credentials_obj) {
        v_credentials_val = val_get_choice_first_set(
            inputval,
            v_credentials_obj);
        while (v_credentials_val) {
            /* process the input variable here */

            /* get the next child set in the selected case */
            v_credentials_val = val_get_choice_next_set(
                v_credentials_obj, 
                v_credentials_val);
        }
    }

    /* remove the next line if scb is used */
    (void)scb;

    /* remove the next line if methnode is used */
    (void)methnode;

    /* this funnction is not supported now */
    (void)v_local_logical_file_path; /* pgr0000 */
    (void)v_remote_file_path;        /* pgr0000 */

    /* invoke your device instrumentation code here */
    
    return res;

} /* u_o_ran_file_management_file_download_invoke */


/********************************************************************
* FUNCTION u_o_ran_file_management_file_upload_notification_send
*
* Send a u_o_ran_file_management_file_upload_notification notification
* Called by your code when notification event occurs
*
********************************************************************/
void u_o_ran_file_management_file_upload_notification_send (
    const xmlChar *v_local_logical_file_path,
    const xmlChar *v_remote_file_path,
    const xmlChar *v_status,
    const xmlChar *v_reject_reason)
{
    val_value_t *parmval = NULL;
    status_t res = NO_ERR;

    if (!agt_notifications_enabled()) {
        log_debug2("\nSkipping <file-upload-notification> notification; disabled");
        return;
    }
    
    if (LOGDEBUG) {
        log_debug("\nGenerating <file-upload-notification> notification");
    }
    
    agt_not_msg_t *notif = agt_not_new_notification(file_upload_notification_obj);
    if (notif == NULL) {
        log_error("\nError: malloc failed, cannot send "
        "<file-upload-notification> notification");
        return;
    }
    
    /* add local_logical_file_path to payload */
    parmval = agt_make_leaf2(
        file_upload_notification_obj,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_local_logical_file_path,
        v_local_logical_file_path,
        &res);
    if (parmval == NULL) {
        log_error(
            "\nError: make leaf failed (%s), cannot send "
            "<file-upload-notification> notification",
            get_error_string(res));
    } else {
        agt_not_add_to_payload(notif, parmval);
    }
    
    /* add remote_file_path to payload */
    parmval = agt_make_leaf2(
        file_upload_notification_obj,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_remote_file_path,
        v_remote_file_path,
        &res);
    if (parmval == NULL) {
        log_error(
            "\nError: make leaf failed (%s), cannot send "
            "<file-upload-notification> notification",
            get_error_string(res));
    } else {
        agt_not_add_to_payload(notif, parmval);
    }
    
    /* add status to payload */
    parmval = agt_make_leaf2(
        file_upload_notification_obj,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_status,
        v_status,
        &res);
    if (parmval == NULL) {
        log_error(
            "\nError: make leaf failed (%s), cannot send "
            "<file-upload-notification> notification",
            get_error_string(res));
    } else {
        agt_not_add_to_payload(notif, parmval);
    }
    
    /* add reject_reason to payload */
    if(xml_strcmp(v_status, D_FLM_RPC_SUCCESS) != 0){
        parmval = agt_make_leaf2(
            file_upload_notification_obj,
            y_o_ran_file_management_M_o_ran_file_management,
            y_o_ran_file_management_N_reject_reason,
            v_reject_reason,
            &res);
        if (parmval == NULL) {
            log_error(
                "\nError: make leaf failed (%s), cannot send "
                "<file-upload-notification> notification",
                get_error_string(res));
        } else {
            agt_not_add_to_payload(notif, parmval);
        }
    }
    sil_sa_queue_notification(notif);
    
} /* u_o_ran_file_management_file_upload_notification_send */


/********************************************************************
* FUNCTION u_o_ran_file_management_file_download_event_send
*
* Send a u_o_ran_file_management_file_download_event notification
* Called by your code when notification event occurs
*
********************************************************************/
void u_o_ran_file_management_file_download_event_send (
    const xmlChar *v_local_logical_file_path,
    const xmlChar *v_remote_file_path,
    const xmlChar *v_status,
    const xmlChar *v_reject_reason)
{
    val_value_t *parmval = NULL;
    status_t res = NO_ERR;

    if (!agt_notifications_enabled()) {
        log_debug2("\nSkipping <file-download-event> notification; disabled");
        return;
    }
    
    if (LOGDEBUG) {
        log_debug("\nGenerating <file-download-event> notification");
    }
    
    agt_not_msg_t *notif = agt_not_new_notification(file_download_event_obj);
    if (notif == NULL) {
        log_error("\nError: malloc failed, cannot send "
        "<file-download-event> notification");
        return;
    }
    
    /* add local_logical_file_path to payload */
    parmval = agt_make_leaf2(
        file_download_event_obj,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_local_logical_file_path,
        v_local_logical_file_path,
        &res);
    if (parmval == NULL) {
        log_error(
            "\nError: make leaf failed (%s), cannot send "
            "<file-download-event> notification",
            get_error_string(res));
    } else {
        agt_not_add_to_payload(notif, parmval);
    }
    
    /* add remote_file_path to payload */
    parmval = agt_make_leaf2(
        file_download_event_obj,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_remote_file_path,
        v_remote_file_path,
        &res);
    if (parmval == NULL) {
        log_error(
            "\nError: make leaf failed (%s), cannot send "
            "<file-download-event> notification",
            get_error_string(res));
    } else {
        agt_not_add_to_payload(notif, parmval);
    }
    
    /* add status to payload */
    parmval = agt_make_leaf2(
        file_download_event_obj,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_status,
        v_status,
        &res);
    if (parmval == NULL) {
        log_error(
            "\nError: make leaf failed (%s), cannot send "
            "<file-download-event> notification",
            get_error_string(res));
    } else {
        agt_not_add_to_payload(notif, parmval);
    }
    
    /* add reject_reason to payload */
    parmval = agt_make_leaf2(
        file_download_event_obj,
        y_o_ran_file_management_M_o_ran_file_management,
        y_o_ran_file_management_N_reject_reason,
        v_reject_reason,
        &res);
    if (parmval == NULL) {
        log_error(
            "\nError: make leaf failed (%s), cannot send "
            "<file-download-event> notification",
            get_error_string(res));
    } else {
        agt_not_add_to_payload(notif, parmval);
    }
    
    sil_sa_queue_notification(notif);
    
} /* u_o_ran_file_management_file_download_event_send */

/********************************************************************
* FUNCTION u_o_ran_file_management_init
*
* initialize the o-ran-file-management server instrumentation library
*
* INPUTS:
*    modname == requested module name
*    revision == requested version (NULL for any)
*
* RETURNS:
*     error status
********************************************************************/
status_t u_o_ran_file_management_init (
    const xmlChar *modname,
    const xmlChar *revision)
{
    status_t res = NO_ERR;
    // move to module global
    //ncx_module_t *o_ran_file_management_mod = NULL;

    o_ran_file_management_mod = ncx_find_module(modname, revision);
    if (o_ran_file_management_mod == NULL) {
        return ERR_NCX_OPERATION_FAILED;
    }

    file_upload_notification_obj = ncx_find_object(
        o_ran_file_management_mod,
        y_o_ran_file_management_N_file_upload_notification);
    if (file_upload_notification_obj == NULL) {
        return ERR_NCX_DEF_NOT_FOUND;
    }

    file_download_event_obj = ncx_find_object(
        o_ran_file_management_mod,
        y_o_ran_file_management_N_file_download_event);
    if (file_download_event_obj == NULL) {
        return ERR_NCX_DEF_NOT_FOUND;
    }

    /* put your module initialization code here */
    
    return res;

} /* u_o_ran_file_management_init */

/********************************************************************
* FUNCTION u_o_ran_file_management_init2
*
* SIL init phase 2: non-config data structures
* Called after running config is loaded
*
* RETURNS:
*     error status
********************************************************************/
status_t u_o_ran_file_management_init2 (void)
{
    status_t res = NO_ERR;

    /* put your init2 code here */
    i_o_ran_file_management_init2();

    return res;

} /* u_o_ran_file_management_init2 */

/********************************************************************
* FUNCTION u_o_ran_file_management_cleanup
*    cleanup the server instrumentation library
*
********************************************************************/
void u_o_ran_file_management_cleanup (void)
{

    /* put your cleanup code here */
    
} /* u_o_ran_file_management_cleanup */

/* END SIL-SA u_o_ran_file_management.c */
