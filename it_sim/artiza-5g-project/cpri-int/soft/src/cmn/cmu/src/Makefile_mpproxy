#------------------------------------------------------
# Makefile for devc library
#------------------------------------------------------
# Target: libbpf_devc
#------------------------------------------------------
TARGET=libcmu_mpproxy.a

#------------------------------------------------------
# Include
#------------------------------------------------------
include ../../../Makefile.in
ifeq ($(BUILD_MODE_DEF), 0)
#------------------------------------------------------
# build top
#------------------------------------------------------
TOP=../../..
OPT=

#------------------------------------------------------
# LIBDIR
#------------------------------------------------------
LIBDIR=$(TOP)/../ramdisk/target/lib

#------------------------------------------------------
# Library
#------------------------------------------------------
LIB=-L$(LIBDIR) -lbpf_svrm \
                    -lbpf_facc \
                    -lbpf_hrtm \
                    -lbpf_string \
                    -lbpf_ipcm \
                    -lbpf_itcm \
                    -lbpf_mblm \
                    -lbpf_devc \
                    -lbpf_log \
                    -lbpf_com \
                    -lmpsw_srv

#------------------------------------------------------
# SYSTEM Includes
#------------------------------------------------------
SYSINC=-I$(TOP)/sys/inc

#------------------------------------------------------
# BPF Includes
#------------------------------------------------------
BPFINC=-I$(TOP)/sys/inc_mw

#------------------------------------------------------
# MPLANE Includes
#------------------------------------------------------
MPINC=-I$(TOP)/mp/public \
      -I$(TOP)/mp/server/interface/msg \
      -I$(TOP)/mp/server/interface/function


#------------------------------------------------------
# ARCH Includes
#------------------------------------------------------

#------------------------------------------------------
# API Includes
#------------------------------------------------------

#------------------------------------------------------
# COM Includes
#------------------------------------------------------
COMINC=-I$(TOP)/cmn/com/inc

#------------------------------------------------------
# CMU Includes
#------------------------------------------------------
CMUINC=-I$(TOP)/cmn/cmu/inc

#------------------------------------------------------
# DCM Includes
#------------------------------------------------------

#------------------------------------------------------
# DFLG
#------------------------------------------------------
DFLG=


#---
# Source Files
#---

SRC=$(shell ls f_mpproxy*.c)
OBJ=$(SRC:.c=.o)


#------------------------------------------------------
# rules
#------------------------------------------------------
all: $(TARGET)
$(TARGET): $(OBJ)
	$(AR) rc $(TARGET) $(OBJ)
	mv $(TARGET) $(LIBDIR)/
.c.o:
	$(CC) $(OPT) $(CFLAGS) -c $< $(INC) $(BPFINC) $(SYSINC) $(MPINC) $(COMINC) $(CMUINC) $(DFLG)

clean:
	rm -f $(LIBDIR)/$(TARGET)
	rm -f *.o *.d
endif

ifeq ($(BUILD_MODE_DEF), 1)
#------------------------------------------------------
# build top
#------------------------------------------------------
TOP=../../..
OPT=

#------------------------------------------------------
# Default Parameters
#------------------------------------------------------
LIBDIR=../../lib

#------------------------------------------------------
# BPF LIBDIR
#------------------------------------------------------
BPF_LIBDIR=$(TOP)/../ramdisk/target/lib
BPF_LIB_DIR_QEMU=$(TOP)/../ramdisk/target/usr/local/lib64
#------------------------------------------------------
# Library C9 modify lbpf_devc -> lbpf_devc_qemu
#------------------------------------------------------
LIB=-L$(BPF_LIBDIR) -L$(BPF_LIB_DIR_QEMU) -lbpf_svrm \
                    -lbpf_facc \
                    -lbpf_hrtm \
                    -lbpf_string \
                    -lbpf_ipcm \
                    -lbpf_itcm \
                    -lbpf_mblm \
                    -lbpf_devc_qemu \
                    -lbpf_log \
                    -lbpf_com \
                    -lmpsw_srv

#------------------------------------------------------
# SYSTEM Includes
#------------------------------------------------------
SYSINC=-I$(TOP)/sys/inc

#------------------------------------------------------
# BPF Includes
#------------------------------------------------------
BPFINC=-I$(TOP)/sys/inc_mw

#------------------------------------------------------
# MPLANE Includes
#------------------------------------------------------
MPINC=-I$(TOP)/mp/public \
      -I$(TOP)/mp/server/interface/msg \
      -I$(TOP)/mp/server/interface/function


#------------------------------------------------------
# ARCH Includes
#------------------------------------------------------

#------------------------------------------------------
# API Includes
#------------------------------------------------------

#------------------------------------------------------
# COM Includes
#------------------------------------------------------
COMINC=-I$(TOP)/cmn/com/inc

#------------------------------------------------------
# CMU Includes
#------------------------------------------------------
CMUINC=-I$(TOP)/cmn/cmu/inc

#------------------------------------------------------
# DCM Includes
#------------------------------------------------------

#------------------------------------------------------
# DFLG
#------------------------------------------------------
DFLG=


#---
# Source Files
#---

SRC=$(shell ls f_mpproxy*.c)
OBJ=$(SRC:.c=.o)


#------------------------------------------------------
# rules
#------------------------------------------------------
all: $(TARGET)
$(TARGET): $(OBJ)
	$(AR) rc $(TARGET) $(OBJ)
	mv $(TARGET) $(LIBDIR)/
.c.o:
	$(CC) $(OPT) $(CFLAGS) -c $< $(INC) $(BPFINC) $(SYSINC) $(MPINC) $(COMINC) $(CMUINC) $(DFLG)

clean:
	rm -f $(LIBDIR)/$(TARGET)
	rm -f *.o *.d
endif